<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text-to-Speech Tool</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 700px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        h2 {
            color: #2c3e50;
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
        }
        .container {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: vertical;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        textarea:focus {
            border-color: #3498db;
            outline: none;
        }
        .voice-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        select {
            flex: 1;
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
            cursor: pointer;
        }
        button {
            padding: 12px 25px;
            font-size: 16px;
            font-weight: 500;
            border: none;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button#toggleBtn { background: #2ecc71; }
        button#stopBtn { background: #e74c3c; }
        button#testVoiceBtn { background: #9b59b6; padding: 10px 20px; }
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        button:active:not(:disabled) { transform: translateY(0); }
        button:disabled { background: #bdc3c7; cursor: not-allowed; }
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }
        .sliders {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 8px;
        }
        label {
            font-size: 14px;
            color: #34495e;
            margin-bottom: 5px;
        }
        input[type="range"] { width: 100%; cursor: pointer; }
        span { font-size: 14px; color: #7f8c8d; }
        #status {
            text-align: center;
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 15px;
            font-style: italic;
        }
        .poem-container {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .poem-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        .poem-btn {
            background: #3498db;
            padding: 10px 15px;
            min-width: 40px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Text-to-Speech Tool</h2>
        <textarea id="textInput" placeholder="Type or paste your text here..."></textarea>
        <div class="voice-controls">
            <select id="voiceSelect"></select>
            <button id="testVoiceBtn">Test Voice</button>
        </div>
        <div class="controls">
            <button id="toggleBtn">Play</button>
            <button id="stopBtn" disabled>Stop</button>
        </div>
        <div class="sliders">
            <div class="slider-container">
                <label for="rate">Rate</label>
                <input type="range" id="rate" min="0.1" max="2" step="0.1" value="1">
                <span id="rateValue">1</span>
            </div>
            <div class="slider-container">
                <label for="pitch">Pitch</label>
                <input type="range" id="pitch" min="0" max="2" step="0.1" value="1">
                <span id="pitchValue">1</span>
            </div>
            <div class="slider-container">
                <label for="volume">Volume</label>
                <input type="range" id="volume" min="0" max="1" step="0.1" value="1">
                <span id="volumeValue">1</span>
            </div>
        </div>
        <div id="status">Ready</div>
    </div>

    <div class="poem-container">
        <h2>Click to read funny poems (courtesy of <a href="https://pun.me/funny/poems/" target="_blank">pun.me</a>)</h2>
        <div class="poem-buttons">
            <button class="poem-btn" onclick="loadPoem(1)">1</button>
            <button class="poem-btn" onclick="loadPoem(2)">2</button>
            <button class="poem-btn" onclick="loadPoem(3)">3</button>
            <button class="poem-btn" onclick="loadPoem(4)">4</button>
            <button class="poem-btn" onclick="loadPoem(5)">5</button>
            <button class="poem-btn" onclick="loadPoem(6)">6</button>
            <button class="poem-btn" onclick="loadPoem(7)">7</button>
            <button class="poem-btn" onclick="loadPoem(8)">8</button>
            <button class="poem-btn" onclick="loadPoem(9)">9</button>
            <button class="poem-btn" onclick="loadPoem(10)">10</button>
        </div>
    </div>

    <script>
        const synth = window.speechSynthesis;
        const textInput = document.getElementById('textInput');
        const voiceSelect = document.getElementById('voiceSelect');
        const toggleBtn = document.getElementById('toggleBtn');
        const stopBtn = document.getElementById('stopBtn');
        const testVoiceBtn = document.getElementById('testVoiceBtn');
        const rate = document.getElementById('rate');
        const pitch = document.getElementById('pitch');
        const volume = document.getElementById('volume');
        const rateValue = document.getElementById('rateValue');
        const pitchValue = document.getElementById('pitchValue');
        const volumeValue = document.getElementById('volumeValue');
        const status = document.getElementById('status');
        let utterance = null;

        const poems = [
            "There once was a man from Peru.\nWho dreamed he was eating his shoe.\nHe woke up at night.\nWith a terrible fright.\nTo find out his dream had come true!",
            "Our school trip was a special occasion.\nBut we never reached our destination.\nInstead of the zoo.\nI was locked in the loo.\nOf the toilet at the service station!",
            "An elderly man called Keith.\nMislaid his set of false teeth.\nThey'd been laid on a chair.\nHe'd forgot they were there.\nSat down, and was bitten beneath.",
            "I eat my peas with honey.\nI've done it all my life.\nIt makes the peas taste funny.\nBut it keeps them on the knife!",
            "She fell into the bath tub.\nShe fell into the sink.\nShe fell into the raspberry jam.\nAnd came out pink!",
            "Roses are red.\nViolets are blue.\nGod made me pretty.\nWhat happened to you!",
            "There was a young lady of Kent.\nWhose nose was most awfully bent.\nShe followed her nose,\nOne day, I suppose,\nAnd no one knows which way she went.",
            "If I were a furry bear.\nAnd had a furry tummy.\nI'd climb into a honey jar\nAnd make my tummy yummy!",
            "There once was a child in Spain.\nWho loved to play in the rain.\nOne day he tripped.\nAnd broke his hip.\nNow he is in serious pain.",
            "Last night at dinner we had some fish,\nAnd though I tried, I did not finish.\nMy mother told me while I chewed,\nBrains loved fish over all other food."
        ];

        function loadVoices() {
            const voices = synth.getVoices();
            voiceSelect.innerHTML = voices.length
                ? voices.map((voice, index) => `<option value="${index}">${voice.name} (${voice.lang})</option>`).join('')
                : '<option value="0">No voices available</option>';
            status.textContent = voices.length ? "Ready" : "No voices available";
            console.log("Loaded voices:", voices.map(v => `${v.name} (${v.lang}) - Default: ${v.default}`));
        }

        function loadPoem(index) {
            textInput.value = poems[index - 1];
            status.textContent = "Poem " + index + " loaded";
        }

        function testVoice() {
            const voices = synth.getVoices();
            if (!voices.length) {
                status.textContent = "No voices available";
                return;
            }
            synth.cancel(); // Reset to ensure fresh state
            const selectedVoice = voices[voiceSelect.value];
            const testUtterance = new SpeechSynthesisUtterance("Hello, this is a test of my voice!");
            testUtterance.voice = selectedVoice;
            testUtterance.rate = parseFloat(rate.value);
            testUtterance.pitch = parseFloat(pitch.value);
            testUtterance.volume = parseFloat(volume.value);
            console.log("Testing voice:", selectedVoice.name, selectedVoice.lang);
            testUtterance.onstart = () => status.textContent = "Testing " + selectedVoice.name + "...";
            testUtterance.onend = () => status.textContent = "Ready";
            testUtterance.onerror = (e) => {
                status.textContent = "Error: " + e.error;
                console.log("Test voice error:", e.error);
            };
            synth.speak(testUtterance);
        }

        loadVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        rate.oninput = () => rateValue.textContent = rate.value;
        pitch.oninput = () => pitchValue.textContent = pitch.value;
        volume.oninput = () => volumeValue.textContent = volume.value;

        function toggleSpeech() {
            const text = textInput.value.trim();
            if (!text) {
                alert("Please enter some text!");
                return;
            }

            const voices = synth.getVoices();
            if (!voices.length) {
                status.textContent = "No voices available";
                return;
            }

            if (!synth.speaking && (!synth.paused || !utterance)) {
                synth.cancel();
                utterance = new SpeechSynthesisUtterance(text);
                utterance.voice = voices[voiceSelect.value];
                utterance.rate = parseFloat(rate.value);
                utterance.pitch = parseFloat(pitch.value);
                utterance.volume = parseFloat(volume.value);

                utterance.onstart = () => {
                    status.textContent = "Speaking...";
                    toggleBtn.textContent = "Pause";
                    stopBtn.disabled = false;
                };
                utterance.onend = () => {
                    status.textContent = "Finished";
                    toggleBtn.textContent = "Play";
                    stopBtn.disabled = true;
                    utterance = null;
                };
                utterance.onpause = () => {
                    status.textContent = "Paused";
                    toggleBtn.textContent = "Resume";
                };
                utterance.onresume = () => {
                    status.textContent = "Speaking...";
                    toggleBtn.textContent = "Pause";
                };
                utterance.onerror = (e) => {
                    status.textContent = "Error: " + e.error;
                    toggleBtn.textContent = "Play";
                    stopBtn.disabled = true;
                };

                synth.speak(utterance);
            } else if (synth.speaking && !synth.paused) {
                synth.pause();
            } else if (synth.paused && utterance) {
                synth.resume();
            }
        }

        function stop() {
            if (synth.speaking || synth.paused || synth.pending) {
                synth.cancel();
                synth.cancel();
                status.textContent = "Stopped";
                toggleBtn.textContent = "Play";
                stopBtn.disabled = true;
                utterance = null;
                setTimeout(() => {
                    if (synth.speaking || synth.paused) synth.cancel();
                }, 100);
            }
        }

        toggleBtn.addEventListener('click', toggleSpeech);
        stopBtn.addEventListener('click', stop);
        testVoiceBtn.addEventListener('click', testVoice);
    </script>
</body>
</html>
